public with sharing class MetadataTypes {
    /*
        The lists METADATA_API and TOOLING_API in METADATA_TYPES_BY_API are being used in the old commit page and are
        no longer applicable in the new commit page as the new commit page has a unified search and does not depend
        on the type of api which supports that metadata. These two lists shall be deprecated soon.
        We now use the list METADATA_TYPES_SUPPORTED_BY_SF_CLI in the new commit page.
     */
    private static final String METADATA_API = 'MetadataAPI';
    private static final String TOOLING_API = 'ToolingAPI';
    private static final Map<String, Set<String>> METADATA_TYPES_BY_API = new Map<String, Set<String>>{
        METADATA_API => new Set<String>{
            'AccountForecastSettings',
            'AccountRelationshipShareRule',
            'AcctMgrTargetSettings',
            'ActionLinkGroupTemplate',
            'AdvAccountForecastSet',
            'AdvAcctForecastDimSource',
            'AdvAcctForecastPeriodGroup',
            'AIApplication',
            'AIApplicationConfig',
            'AnalyticSnapshot',
            'AnimationRule',
            'ApexEmailNotifications',
            'ApexTestSuite',
            'AppMenu',
            'ApprovalProcess',
            'ArchiveSettings',
            'AssignmentRules',
            'Audience',
            'AuthProvider',
            'AutoResponseRules',
            'BatchCalcJobDefinition',
            'BatchProcessJobDefinition',
            'BlacklistedConsumer',
            'BlockchainSettings',
            'BranchManagementSettings',
            'CallCenter',
            'CallCoachingMediaProvider',
            'CanvasMetadata',
            'CareBenefitVerifySettings',
            'ChannelLayout',
            'ChatterExtension',
            'CMSConnectSource',
            'CommerceSettings',
            'Community',
            'CommunityTemplateDefinition',
            'CommunityThemeDefinition',
            'ConnectedApp',
            'ContentAsset',
            'ConversationMessageDefinition',
            'CorsWhitelistOrigin',
            'CspTrustedSite',
            'CustomApplicationComponent',
            'CustomerDataPlatformSettings',
            'CustomFeedFilter',
            'CustomHelpMenuSection',
            'CustomIndex',
            'CustomMetadata',
            'CustomNotificationType',
            'CustomObjectTranslation',
            'CustomPageWebLink',
            'CustomPermission',
            'CustomSite',
            'CustomTab',
            'CustomValue',
            'Dashboard',
            'DashboardFolder',
            'DataCategoryGroup',
            'DecisionTable',
            'DecisionTableDatasetLink',
            'DelegateGroup',
            'DiscoverySettings',
            'Document',
            'DocumentChecklistSettings',
            'DocumentFolder',
            'DocumentType',
            'DuplicateRule',
            'EclairGeoData',
            'EinsteinAssistantSettings',
            'EinsteinDocumentCaptureSettings',
            'EmailFolder',
            'EmailServicesFunction',
            'EmailTemplateFolder',
            'EmbeddedServiceFlowConfig',
            'EmployeeFieldAccessSettings',
            'EntitlementProcess',
            'EntitlementTemplate',
            'EntityImplements',
            'EscalationRules',
            'EssentialsSettings',
            'ExperienceBundle',
            'FeatureParameterBoolean',
            'FeatureParameterDate',
            'FeatureParameterInteger',
            'FlowCategory',
            'FlowCategory',
            'FormulaSettings',
            'GatewayProviderPaymentMethodType',
            'GlobalValueSetTranslation',
            'GoogleAppsSettings',
            'Index',
            'IndustriesManufacturingSettings',
            'InstalledPackage',
            'Letterhead',
            'LightningBolt',
            'LightningExperienceTheme',
            'LightningMessageChannel',
            'LightningOnboardingConfig',
            'ListView',
            'ManagedTopics',
            'MilestoneType',
            'MLDataDefinition',
            'MLPredictionDefinition',
            'MLRecommendationDefinition',
            'MobileApplicationDetail',
            'MutingPermissionSet',
            'MyDomainDiscoverableLogin',
            'NavigationMenu',
            'Network',
            'NetworkBranding',
            'NotificationTypeConfig',
            'OauthCustomScope',
            'ObjectHierarchyRelationship',
            'PaymentGatewayProvider',
            'PicklistValue',
            'PlatformCachePartition',
            'PresenceDeclineReason',
            'PresenceUserConfig',
            'ProfilePasswordPolicy',
            'ProfileSessionSetting',
            'Profile',
            'Prompt',
            'Queue',
            'QueueRoutingConfig',
            'RecordType',
            'RedirectWhitelistUrl',
            'RemoteSiteSetting',
            'Report',
            'ReportFolder',
            'ReportType',
            'RestrictionRule',
            'Role',
            'SamlSsoConfig',
            'ServiceChannel',
            'ServicePresenceStatus',
            'Settings',
            'SharingCriteriaRule',
            'SharingGuestRule',
            'SharingOwnerRule',
            'SharingReason',
            'SharingRules',
            'SharingSet',
            'SharingTerritoryRule',
            'SiteDotCom',
            'SlackApp',
            'StandardValue',
            'StandardValueSet',
            'StandardValueSetTranslation',
            'SynonymDictionary',
            'TopicsForObjects',
            'Translations',
            'UserProvisioningConfig',
            'ViewDefinition',
            'Workflow',
            'WorkflowFlowAction',
            'WorkflowKnowledgePublish',
            'WorkflowSend',
            'WorkflowTask'
        },
        TOOLING_API => new Set<String>{
            'ApexClass',
            'ApexComponent',
            'ApexPage',
            'ApexTrigger',
            'AuraDefinitionBundle',
            'BrandingSet',
            'BriefcaseDefinition',
            'BusinessProcess',
            'BusinessProcessGroup',
            'Certificate',
            'CleanDataService',
            'CompactLayout',
            'CustomApplication',
            'CustomField',
            'CustomLabel',
            'CustomObject',
            'EmailTemplate',
            'EmbeddedServiceBranding',
            'EmbeddedServiceConfig',
            'EmbeddedServiceLiveAgent',
            'EmbeddedServiceMenuSettings',
            'ExternalDataSource',
            'ExternalServiceRegistration',
            'ExternalServicesSettings',
            'FieldRestrictionRule',
            'FieldSet',
            'FlexiPage',
            'Flow',
            'FlowDefinition',
            'GlobalValueSet',
            'Group',
            'HomePageComponent',
            'HomePageLayout',
            'InboundNetworkConnection',
            'IPAddressRange',
            'KeywordList',
            'Layout',
            'LightningComponentBundle',
            'ManagedContentType',
            'MatchingRules',
            'ModerationRule',
            'NamedCredential',
            'OutboundNetworkConnection',
            'PathAssistant',
            'PermissionSet',
            'PermissionSetGroup',
            'PlatformEventChannel',
            'PlatformEventChannelMember',
            'PlatformEventSubscriberConfig',
            'QuickAction',
            'RecommendationStrategy',
            'RecordActionDeployment',
            'StaticResource',
            'TimeSheetTemplate',
            'TransactionSecurityPolicy',
            'UserCriteria',
            'ValidationRule',
            'WebLink',
            'WorkflowAlert',
            'WorkflowFieldUpdate',
            'WorkflowOutboundMessage',
            'WorkflowRule',
            'WorkSkillRouting'
        }
    };

    private static final Set<String> METADATA_TYPES_SUPPORTED_BY_SF_CLI = new Set<String>{
        'AccessControlPolicy',
        'AccountForecastSettings',
        'AccountingFieldMapping',
        'AccountingModelConfig',
        'AccountRelationshipShareRule',
        'AcctMgrTargetSettings',
        'ActionLauncherItemDef',
        'ActionLinkGroupTemplate',
        'ActionPlanTemplate',
        'ActionableEventOrchDef',
        'ActionableEventTypeDef',
        'ActionableListDefinition',
        'ActivationPlatform',
        'ActnblListKeyPrfmIndDef',
        'AdvAccountForecastSet',
        'AdvAcctForecastDimSource',
        'AdvAcctForecastPeriodGroup',
        'AffinityScoreDefinition',
        'AIApplication',
        'AIApplicationConfig',
        'AIAssistantTemplate',
        'AiEvaluationDefinition',
        'AIScoringModelDefVersion',
        'AIScoringModelDefinition',
        'AIUsecaseDefinition',
        'AnalyticSnapshot',
        'AnalyticsDashboard',
        'AnalyticsVisualization',
        'AnalyticsWorkspace',
        'AnimationRule',
        'ApexClass',
        'ApexComponent',
        'ApexEmailNotifications',
        'ApexPage',
        'ApexTestSuite',
        'ApexTrigger',
        'ApiNamedQuery',
        'AppFrameworkTemplateBundle',
        'AppMenu',
        'ApplicationRecordTypeConfig',
        'ApplicationSubtypeDefinition',
        'AppointmentAssignmentPolicy',
        'AppointmentSchedulingPolicy',
        'ApprovalProcess',
        'AssessmentConfiguration',
        'AssessmentQuestion',
        'AssessmentQuestionSet',
        'AssignmentRule',
        'AssignmentRules',
        'AssistantContextItem',
        'AssistantDefinition',
        'AssistantRecommendationType',
        'AssistantSkillQuickAction',
        'AssistantSkillSobjectAction',
        'AssistantVersion',
        'Audience',
        'AuraDefinitionBundle',
        'AuthProvider',
        'AutoResponseRule',
        'AutoResponseRules',
        'BatchCalcJobDefinition',
        'BatchProcessJobDefinition',
        'BenefitAction',
        'BlacklistedConsumer',
        'BldgEnrgyIntensityCnfg',
        'Bot',
        'BotBlock',
        'BotTemplate',
        'BotVersion',
        'BrandingSet',
        'BriefcaseDefinition',
        'BusinessProcess',
        'BusinessProcessFeedbackConfiguration',
        'BusinessProcessGroup',
        'BusinessProcessTypeDefinition',
        'CallCenter',
        'CallCenterRoutingMap',
        'CallCoachingMediaProvider',
        'CallCtrAgentFavTrfrDest',
        'CampaignInfluenceModel',
        'CanvasMetadata',
        'CareBenefitVerifySettings',
        'CareLimitType',
        'CareProviderAfflRoleConfig',
        'CareProviderSearchConfig',
        'CareRequestConfiguration',
        'CareSystemFieldMapping',
        'CaseSubjectParticle',
        'CatalogedApi',
        'CatalogedApiArtifactVersionInfo',
        'CatalogedApiVersion',
        'Certificate',
        'ChannelLayout',
        'ChannelObjectLinkingRule',
        'ChatterExtension',
        'ChoiceList',
        'ClauseCatgConfiguration',
        'CleanDataService',
        'CMSConnectSource',
        'CommandAction',
        'Community',
        'CommunityTemplateDefinition',
        'CommunityThemeDefinition',
        'CompactLayout',
        'ConnectedApp',
        'ContentAsset',
        'ContentTypeBundle',
        'ContextDefinition',
        'ContextUseCaseMapping',
        'ContractType',
        'ConversationChannelDefinition',
        'ConversationMessageDefinition',
        'ConversationVendorFieldDef',
        'ConversationVendorInfo',
        'ConvIntelligenceSignalRule',
        'CorsWhitelistOrigin',
        'CspTrustedSite',
        'CustomApplication',
        'CustomApplicationComponent',
        'CustomDataType',
        'CustomExperience',
        'CustomFeedFilter',
        'CustomField',
        'CustomFieldTranslation',
        'CustomHelpMenuSection',
        'CustomIndex',
        'CustomLabel',
        'CustomLabels',
        'CustomMetadata',
        'CustomNotificationType',
        'CustomObject',
        'CustomObjectTranslation',
        'CustomPageWebLink',
        'CustomPermission',
        'CustomSite',
        'CustomTab',
        'Dashboard',
        'DashboardFolder',
        'DataCalcInsightTemplate',
        'DataCategoryGroup',
        'DataConnector',
        'DataConnectorIngestApi',
        'DataConnectorS3',
        'DataKitObjectDependency',
        'DataKitObjectTemplate',
        'DataObjectBuildOrgTemplate',
        'DataPackageKitDefinition',
        'DataPackageKitObject',
        'DataPipeline',
        'DataSource',
        'DataSourceBundleDefinition',
        'DataSourceObject',
        'DataSourceTenant',
        'DataSrcDataModelFieldMap',
        'DataStreamDefinition',
        'DataStreamTemplate',
        'DataWeaveResource',
        'DecisionMatrixDefinition',
        'DecisionMatrixDefinitionVersion',
        'DecisionTable',
        'DecisionTableDatasetLink',
        'DelegateGroup',
        'DgtAssetMgmtProvider',
        'DgtAssetMgmtPrvdLghtCpnt',
        'DigitalExperience',
        'DigitalExperienceBundle',
        'DigitalExperienceConfig',
        'DisclosureDefinition',
        'DisclosureDefinitionVersion',
        'DisclosureType',
        'DiscoveryAIModel',
        'DiscoveryGoal',
        'DiscoveryStory',
        'Document',
        'DocumentCategory',
        'DocumentCategoryDocumentType',
        'DocumentFolder',
        'DocumentGenerationSetting',
        'DocumentTemplate',
        'DocumentType',
        'DuplicateRule',
        'DynamicTrigger',
        'EclairGeoData',
        'EmailFolder',
        'EmailServicesFunction',
        'EmailTemplate',
        'EmailTemplateFolder',
        'EmbeddedServiceBranding',
        'EmbeddedServiceConfig',
        'EmbeddedServiceFieldService',
        'EmbeddedServiceFlowConfig',
        'EmbeddedServiceLiveAgent',
        'EmbeddedServiceMenuSettings',
        'EmployeeDataSyncProfile',
        'EnablementMeasureDefinition',
        'EnablementProgramDefinition',
        'EnblProgramTaskSubCategory',
        'EntitlementProcess',
        'EntitlementTemplate',
        'EntityImplements',
        'EscalationRule',
        'EscalationRules',
        'ESignatureConfig',
        'ESignatureEnvelopeConfig',
        'EventDelivery',
        'EventRelayConfig',
        'EventSubscription',
        'EventType',
        'ExperienceBundle',
        'ExperiencePropertyTypeBundle',
        'ExplainabilityActionDefinition',
        'ExplainabilityActionVersion',
        'ExplainabilityMsgTemplate',
        'ExpressionSetDefinition',
        'ExpressionSetDefinitionVersion',
        'ExpressionSetMessageToken',
        'ExpressionSetObjectAlias',
        'extDataTranFieldTemplate',
        'ExtDataTranObjectTemplate',
        'ExternalAIModel',
        'ExternalAuthIdentityProvider',
        'ExternalClientApplication',
        'ExternalCredential',
        'ExternalDataConnector',
        'ExternalDataSource',
        'ExternalDataTranObject',
        'ExternalDocStorageConfig',
        'ExternalServiceRegistration',
        'ExternalStoragePrvdConfig',
        'ExtlClntAppCanvasStngs',
        'ExtlClntAppConfigurablePolicies',
        'ExtlClntAppGlobalOauthSettings',
        'ExtlClntAppMobileConfigurablePolicies',
        'ExtlClntAppMobileSettings',
        'ExtlClntAppNotificationSettings',
        'ExtlClntAppOauthConfigurablePolicies',
        'ExtlClntAppOauthSettings',
        'ExtlClntAppPushConfigurablePolicies',
        'ExtlClntAppPushSettings',
        'ExtlClntAppSamlConfigurablePolicies',
        'ExtlClntAppSampleConfigurablePolicies',
        'ExtlClntAppSampleSettings',
        'FeatureParameterBoolean',
        'FeatureParameterDate',
        'FeatureParameterInteger',
        'FieldMappingConfig',
        'FieldMappingConfigItem',
        'FieldRestrictionRule',
        'FieldServiceMobileConfig',
        'FieldServiceMobileExtension',
        'FieldSet',
        'FieldSrcTrgtRelationship',
        'FlexiPage',
        'Flow',
        'FlowCategory',
        'FlowDefinition',
        'FlowTest',
        'ForecastingFilter',
        'ForecastingFilterCondition',
        'ForecastingGroup',
        'ForecastingSourceDefinition',
        'ForecastingType',
        'ForecastingTypeSource',
        'Form',
        'FormSection',
        'FuelType',
        'FuelTypeSustnUom',
        'FunctionReference',
        'FundraisingConfig',
        'GatewayProviderPaymentMethodType',
        'GenAiFunction',
        'GenAiPlanner',
        'GenAiPlannerBundle',
        'GenAiPlugin',
        'GenAiPromptTemplate',
        'GenAiPromptTemplateActv',
        'GlobalPicklist',
        'GlobalValueSet',
        'GlobalValueSetTranslation',
        'Group',
        'HomePageComponent',
        'HomePageLayout',
        'Icon',
        'IdentityVerificationProcDef',
        'IframeWhiteListUrlSettings',
        'InboundCertificate',
        'InboundNetworkConnection',
        'Index',
        'IndustriesManufacturingSettings',
        'InsightType',
        'InstalledPackage',
        'IntegrationHubSettings',
        'IntegrationHubSettingsType',
        'IntegrationProviderDef',
        'InternalDataConnector',
        'InternalOrganization',
        'InvocableActionExtension',
        'IPAddressRange',
        'KeywordList',
        'Layout',
        'LeadConvertSettings',
        'LearningAchievementConfig',
        'LearningItemType',
        'Letterhead',
        'LicenseDefinition',
        'LifeSciConfigCategory',
        'LifeSciConfigRecord',
        'LightningBolt',
        'LightningComponentBundle',
        'LightningExperienceTheme',
        'LightningMessageChannel',
        'LightningOnboardingConfig',
        'LightningTypeBundle',
        'ListView',
        'LiveChatAgentConfig',
        'LiveChatButton',
        'LiveChatDeployment',
        'LiveChatSensitiveDataRule',
        'LocationUse',
        'LoyaltyProgramSetup',
        'ManagedContentType',
        'ManagedEventSubscription',
        'ManagedTopic',
        'ManagedTopics',
        'MarketingAppExtension',
        'MarketingResourceType',
        'MarketSegmentDefinition',
        'MatchingRule',
        'MatchingRules',
        'MessagingChannel',
        'MfgProgramTemplate',
        'MilestoneType',
        'MktCalcInsightObjectDef',
        'MktDataConnection',
        'MktDataConnectionSrcParam',
        'MktDataTranField',
        'MktDataTranObject',
        'MLDataDefinition',
        'MlDomain',
        'MLPredictionDefinition',
        'MLRecommendationDefinition',
        'MobileApplicationDetail',
        'MobileSecurityAssignment',
        'MobileSecurityPolicy',
        'MobileSecurityPolicySet',
        'MobSecurityCertPinConfig',
        'ModerationRule',
        'MutingPermissionSet',
        'MyDomainDiscoverableLogin',
        'NamedCredential',
        'NavigationMenu',
        'Network',
        'NetworkBranding',
        'NotificationTypeConfig',
        'OauthCustomScope',
        'OauthTokenExchangeHandler',
        'ObjectHierarchyRelationship',
        'ObjectSourceTargetMap',
        'ObjIntegProviderDefMapping',
        'OcrSampleDocument',
        'OcrTemplate',
        'OmniDataTransform',
        'OmniExtTrackingDef',
        'OmniIntegrationProcedure',
        'OmniInteractionAccessConfig',
        'OmniInteractionConfig',
        'OmniScript',
        'OmniSupervisorConfig',
        'OmniTrackingGroup',
        'OmniUiCard',
        'Orchestration',
        'OrchestrationContext',
        'OutboundNetworkConnection',
        'ParticipantRole',
        'PathAssistant',
        'PaymentGatewayProvider',
        'PermissionSet',
        'PermissionSetGroup',
        'PermissionSetLicenseDefinition',
        'PersonAccountOwnerPowerUser',
        'PipelineInspMetricConfig',
        'PlatformCachePartition',
        'PlatformEventChannel',
        'PlatformEventChannelMember',
        'PlatformEventSubscriberConfig',
        'Portal',
        'PortalDelegablePermissionSet',
        'PostTemplate',
        'PresenceDeclineReason',
        'PresenceUserConfig',
        'PricingActionParameters',
        'PricingRecipe',
        'ProcessFlowMigration',
        'ProductAttrDisplayConfig',
        'ProductAttributeSet',
        'ProductSpecificationRecType',
        'ProductSpecificationType',
        'ProductSpecificationTypeDefinition',
        'Profile',
        'ProfilePasswordPolicy',
        'ProfileSessionSetting',
        'Prompt',
        'PublicKeyCertificate',
        'PublicKeyCertificateSet',
        'Queue',
        'QueueRoutingConfig',
        'QuickAction',
        'RecAlrtDataSrcExpSetDef',
        'RecommendationStrategy',
        'RecordActionDeployment',
        'RecordAggregationDefinition',
        'RecordAlertCategory',
        'RecordAlertDataSource',
        'RecordAlertTemplate',
        'RecordType',
        'RedirectWhitelistUrl',
        'ReferencedDashboard',
        'RegisteredExternalService',
        'RelatedRecordAssocCriteria',
        'RelationshipGraphDefinition',
        'RemoteSiteSetting',
        'Report',
        'ReportFolder',
        'ReportType',
        'RestrictionRule',
        'RetrievalSummaryDefinition',
        'Role',
        'RuleLibraryDefinition',
        'SalesAgreementSettings',
        'SamlSsoConfig',
        'SchedulingObjective',
        'SchedulingRule',
        'Scontrol',
        'ScoreCategory',
        'SearchCriteriaConfiguration',
        'SearchCustomization',
        'SearchOrgWideObjectConfig',
        'SearchableObjDataSyncInfo',
        'ServiceAISetupDefinition',
        'ServiceAISetupField',
        'ServiceChannel',
        'ServicePresenceStatus',
        'ServiceProcess',
        'Settings',
        'SharingCriteriaRule',
        'SharingGuestRule',
        'SharingOwnerRule',
        'SharingReason',
        'SharingRules',
        'SharingSet',
        'SharingTerritoryRule',
        'SiteDotCom',
        'Skill',
        'SkillType',
        'SlackApp',
        'StageDefinition',
        'StandardValueSet',
        'StandardValueSetTranslation',
        'StaticResource',
        'StnryAssetEnvSrcCnfg',
        'StreamingAppDataConnector',
        'SustainabilityUom',
        'SustnUomConversion',
        'SvcCatalogCategory',
        'SvcCatalogFilterCondition',
        'SvcCatalogFilterCriteria',
        'SvcCatalogFulfillmentFlow',
        'SvcCatalogItemDef',
        'SvcCatalogItemDefFiltrCrit',
        'SynonymDictionary',
        'Territory',
        'Territory2',
        'Territory2Model',
        'Territory2Rule',
        'Territory2Type',
        'TimelineObjectDefinition',
        'TimeSheetTemplate',
        'TopicsForObjects',
        'TransactionSecurityPolicy',
        'Translations',
        'UiFormatSpecificationSet',
        'UIObjectRelationConfig',
        'UiPlugin',
        'UiPreviewMessageTabDef',
        'UiViewDefinition',
        'UserAccessPolicy',
        'UserAuthCertificate',
        'UserCriteria',
        'UserProfileSearchScope',
        'UserProvisioningConfig',
        'ValidationRule',
        'VehicleAssetEmssnSrcCnfg',
        'ViewDefinition',
        'VirtualVisitConfig',
        'VisualizationPlugin',
        'WaveAnalyticAssetCollection',
        'WaveApplication',
        'WaveComponent',
        'WaveDashboard',
        'WaveDataflow',
        'WaveDataset',
        'WaveLens',
        'WaveRecipe',
        'WaveTemplateBundle',
        'WaveXmd',
        'WebLink',
        'WebStoreBundle',
        'WebStoreTemplate',
        'Workflow',
        'WorkflowAlert',
        'WorkflowFieldUpdate',
        'WorkflowFlowAction',
        'WorkflowFlowAutomation',
        'WorkflowKnowledgePublish',
        'WorkflowOutboundMessage',
        'WorkflowRule',
        'WorkflowSend',
        'WorkflowTask',
        'WorkSkillRouting',
        'WorkSkillRoutingAttribute',
        'XOrgHub'
    };    

    @TestVisible
    private static final List<String> METADATA_TYPES_NOT_SUPPORTED_IN_PARTIAL_REFRESH = new List<String>{
        'EmailTemplateFolder',
        'EmailFolder',
        'DashboardFolder',
        'ReportFolder',
        'DocumentFolder'
    };

    @TestVisible
    private static final List<String> METADATA_TYPES_NOT_SUPPORTED_IN_GIT_SNAPSHOT = new List<String>{
        'AssignmentRule',
        'AutoResponseRule',
        'BusinessProcess',
        'CompactLayout',
        'CustomField',
        'CustomLabels',
        'DashboardFolder',
        'DocumentFolder',
        'EmailFolder',
        'EmailTemplateFolder',
        'EscalationRule',
        'FieldSet',
        'Index',
        'ListView',
        'MatchingRule',
        'RecordType',
        'ReportFolder',
        'SharingCriteriaRule',
        'SharingGuestRule',
        'SharingOwnerRule',
        'SharingReason',
        'SharingTerritoryRule',
        'ValidationRule',
        'WebLink',
        'WorkflowAlert',
        'WorkflowFieldUpdate',
        'WorkflowFlowAction',
        'WorkflowFlowAutomation',
        'WorkflowKnowledgePublish',
        'WorkflowOutboundMessage',
        'WorkflowRule',
        'WorkflowSend',
        'WorkflowTask'
    };

    public static List<String> toolingApiTypes() {
        List<String> result = new List<String>(METADATA_TYPES_BY_API.get(TOOLING_API));
        result.sort();
        return result;
    }

    public static List<String> metadataApiTypes() {
        List<String> result = new List<String>(METADATA_TYPES_BY_API.get(METADATA_API));
        result.sort();
        return result;
    }

    @AuraEnabled(cacheable=true)
    public static List<String> supportedMetadataTypes() {
        List<String> result = new List<String>();
        result.addAll(metadataApiTypes());
        result.addAll(toolingApiTypes());
        result.sort();
        return result;
    }

    @AuraEnabled(cacheable=true)
    public static List<String> supportedMetadataTypesInPartialRefresh() {
        List<String> result = new List<String>();
        result.addAll(METADATA_TYPES_SUPPORTED_BY_SF_CLI);

        /*
        Removed 'EmailTemplateFolder', 'EmailFolder', 'DashboardFolder', 'ReportFolder' from the partial refresh picklist since
        the Metadata Refresh Service does not retrieve any metadata when we request a refresh for the above metadatas
        Only when we refresh for example,  Dashboard that the DashboardFolder names are also appended to the Metadata index file.
        */
        result = filterInvalidTypes(result, METADATA_TYPES_NOT_SUPPORTED_IN_PARTIAL_REFRESH);
        result.sort();
        return result;
    }

    /*
        EmailTemplateFolder is understood as EmailFolder in the retrieve result from the sf cli. Hence we 
        prefer to put EmailFolder as opposed to EmailTemplateFolder since keeping both can cause confusion and commit failures.
    */
    @AuraEnabled(cacheable=true)
    public static List<String> metadataTypesNotSupportedInCommitPageFilters() {
        return new List<String>{ 'EmailTemplateFolder' };
    }

    private static List<String> filterInvalidTypes(List<String> allMetadataTypes, List<String> metadataTypesToBeRemoved) {
        List<String> result = new List<String>();
        for (String metadataType : allMetadataTypes) {
            if (!(metadataTypesToBeRemoved?.contains(metadataType))) {
                result.add(metadataType);
            }
        }
        return result;
    }

    @AuraEnabled(cacheable=true)
    public static List<String> metadataTypesSupportedInGitSnapshot() {
        List<String> result = new List<String>();
        result.addAll(METADATA_TYPES_SUPPORTED_BY_SF_CLI);
        result = filterInvalidTypes(result, METADATA_TYPES_NOT_SUPPORTED_IN_GIT_SNAPSHOT);
        result.sort();
        return result;
    }
}